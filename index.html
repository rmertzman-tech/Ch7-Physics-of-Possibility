<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Physics of Possibility: Constructor Theory</title>
    <style>
        :root {
            --primary: #2c5282;
            --secondary: #4299e1;
            --success: #48bb78;
            --warning: #ed8936;
            --danger: #f56565;
            --purple: #805ad5;
            --teal: #319795;
            --background: #f7fafc;
            --card-bg: #ffffff;
            --text: #2d3748;
            --text-light: #718096;
            --border: #e2e8f0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: var(--text);
            background: var(--background);
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        header {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 30px;
            text-align: center;
        }

        header h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .progress-container {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .progress-bar {
            width: 100%;
            height: 30px;
            background: var(--border);
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--secondary), var(--success));
            width: 0%;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .module {
            background: var(--card-bg);
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            display: none;
        }

        .module.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .module h2 {
            color: var(--primary);
            margin-bottom: 20px;
            font-size: 1.8em;
            border-bottom: 3px solid var(--secondary);
            padding-bottom: 10px;
        }

        .module h3 {
            color: var(--primary);
            margin-top: 25px;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .learning-objective {
            background: #ebf8ff;
            border-left: 4px solid var(--secondary);
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .reading-connection {
            background: #fef5e7;
            border-left: 4px solid var(--warning);
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .reading-connection::before {
            content: "üìñ Reading Connection: ";
            font-weight: bold;
            color: var(--warning);
        }

        .key-concept {
            background: #e6fffa;
            border-left: 4px solid var(--teal);
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .key-concept-title {
            font-weight: bold;
            color: #234e52;
            margin-bottom: 8px;
        }

        .interactive-section {
            background: #f7fafc;
            border: 2px solid var(--border);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }

        /* Trajectory vs Counterfactual */
        .universe-comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .universe-view {
            padding: 20px;
            border-radius: 12px;
            border: 3px solid var(--border);
            min-height: 300px;
        }

        .universe-view h4 {
            margin-bottom: 15px;
            color: var(--primary);
        }

        .trajectory-canvas {
            width: 100%;
            height: 200px;
            background: #2d3748;
            border-radius: 8px;
            position: relative;
            overflow: hidden;
        }

        .ball {
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            position: absolute;
            box-shadow: 0 0 10px rgba(255,255,255,0.5);
        }

        .possibility-space {
            width: 100%;
            height: 200px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 8px;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
            padding: 10px;
        }

        .possibility-bubble {
            width: 60px;
            height: 60px;
            background: rgba(255,255,255,0.2);
            border: 2px solid white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 5px;
            font-size: 0.8em;
            color: white;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .possibility-bubble:hover {
            background: rgba(255,255,255,0.4);
            transform: scale(1.1);
        }

        /* Constructor vs Reactant */
        .agent-comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .agent-card {
            padding: 20px;
            border-radius: 12px;
            border: 3px solid var(--border);
        }

        .agent-card.reactant {
            background: linear-gradient(135deg, #fed7d7, #fbb6ce);
            border-color: var(--danger);
        }

        .agent-card.constructor {
            background: linear-gradient(135deg, #c6f6d5, #9ae6b4);
            border-color: var(--success);
        }

        .agent-icon {
            font-size: 3em;
            text-align: center;
            margin-bottom: 10px;
        }

        .agent-capacity {
            margin: 15px 0;
        }

        .capacity-bar {
            width: 100%;
            height: 25px;
            background: var(--border);
            border-radius: 12px;
            overflow: hidden;
            margin: 8px 0;
        }

        .capacity-fill {
            height: 100%;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9em;
            font-weight: bold;
            color: white;
        }

        /* Knowledge Transformer */
        .transformation-demo {
            margin: 20px 0;
        }

        .transformation-stage {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 20px;
            align-items: center;
            margin: 20px 0;
        }

        .state-box {
            padding: 30px;
            border-radius: 12px;
            border: 3px solid var(--border);
            text-align: center;
            min-height: 150px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .state-box.before {
            background: #fed7d7;
            border-color: var(--danger);
        }

        .state-box.after {
            background: #c6f6d5;
            border-color: var(--success);
        }

        .transform-arrow {
            font-size: 3em;
            color: var(--primary);
        }

        .knowledge-input {
            margin: 20px 0;
        }

        .knowledge-options {
            display: grid;
            gap: 10px;
            margin: 15px 0;
        }

        .knowledge-option {
            padding: 15px;
            border: 2px solid var(--border);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            background: white;
        }

        .knowledge-option:hover {
            border-color: var(--secondary);
            background: #ebf8ff;
        }

        .knowledge-option.selected {
            background: var(--secondary);
            color: white;
            border-color: var(--primary);
        }

        /* Universal Constructor */
        .constructor-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .constructor-entity {
            padding: 20px;
            border-radius: 12px;
            border: 3px solid var(--border);
            background: white;
        }

        .constructor-entity h4 {
            color: var(--primary);
            margin-bottom: 10px;
        }

        .capability-list {
            margin: 15px 0;
        }

        .capability-item {
            padding: 8px;
            margin: 5px 0;
            border-radius: 6px;
            background: #e6fffa;
            border-left: 3px solid var(--teal);
            font-size: 0.9em;
        }

        .capability-locked {
            background: #e2e8f0;
            border-left-color: var(--text-light);
            color: var(--text-light);
        }

        /* Code Integrity Meter */
        .integrity-tracker {
            margin: 20px 0;
        }

        .action-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .action-button {
            padding: 20px;
            border-radius: 12px;
            border: 3px solid var(--border);
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            background: white;
        }

        .action-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
        }

        .action-button.degrading {
            border-color: var(--danger);
        }

        .action-button.maintaining {
            border-color: var(--success);
        }

        .integrity-meter {
            margin: 20px 0;
            padding: 20px;
            background: white;
            border-radius: 12px;
        }

        .integrity-bar {
            width: 100%;
            height: 40px;
            background: var(--border);
            border-radius: 20px;
            overflow: hidden;
        }

        .integrity-fill {
            height: 100%;
            transition: width 0.5s ease, background 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        /* Optimism Calculator */
        .problem-analyzer {
            margin: 20px 0;
        }

        .problem-input {
            margin: 20px 0;
        }

        .problem-input input,
        .problem-input textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 6px;
            font-size: 1em;
            font-family: inherit;
        }

        .problem-input textarea {
            min-height: 100px;
            resize: vertical;
        }

        .analysis-result {
            margin: 20px 0;
            padding: 20px;
            border-radius: 12px;
            display: none;
        }

        .analysis-result.impossible {
            background: #fed7d7;
            border: 3px solid var(--danger);
        }

        .analysis-result.possible {
            background: #c6f6d5;
            border: 3px solid var(--success);
        }

        /* Constructor's Dashboard */
        .dashboard {
            margin: 20px 0;
        }

        .dashboard-checklist {
            display: grid;
            gap: 15px;
            margin: 20px 0;
        }

        .dashboard-item {
            padding: 20px;
            border-radius: 12px;
            border: 3px solid var(--border);
            background: white;
        }

        .dashboard-item h4 {
            color: var(--primary);
            margin-bottom: 10px;
        }

        .dashboard-item textarea,
        .dashboard-item select {
            width: 100%;
            padding: 10px;
            border: 2px solid var(--border);
            border-radius: 6px;
            font-family: inherit;
            font-size: 1em;
            margin-top: 10px;
        }

        .dashboard-result {
            margin-top: 20px;
            padding: 20px;
            border-radius: 12px;
            display: none;
        }

        .dashboard-result.proceed {
            background: #c6f6d5;
            border: 3px solid var(--success);
        }

        .dashboard-result.learn {
            background: #fef5e7;
            border: 3px solid var(--warning);
        }

        .dashboard-result.redesign {
            background: #fed7d7;
            border: 3px solid var(--danger);
        }

        /* P-adic Identity Builder */
        .padic-builder {
            margin: 20px 0;
        }

        .padic-layer {
            margin: 20px 0;
        }

        .value-options {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
        }

        .value-checkbox {
            display: flex;
            align-items: center;
            padding: 12px;
            background: #f7fafc;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .value-checkbox:hover {
            background: #edf2f7;
            border-color: #4299e1;
        }

        .value-checkbox input[type="checkbox"] {
            margin-right: 12px;
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .value-checkbox input[type="checkbox"]:disabled {
            cursor: not-allowed;
        }

        .value-checkbox span {
            font-size: 1em;
            color: #2d3748;
        }

        .formula {
            background: #f7fafc;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            text-align: center;
            border: 2px solid #e2e8f0;
        }

        /* Buttons */
        button {
            background: var(--secondary);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }

        button:hover {
            background: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        button:disabled {
            background: var(--text-light);
            cursor: not-allowed;
            transform: none;
        }

        button.primary { background: var(--primary); }
        button.success { background: var(--success); }
        button.danger { background: var(--danger); }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid var(--border);
        }

        .checkpoint {
            background: #fff5f5;
            border: 2px solid var(--danger);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }

        .checkpoint-title {
            font-weight: bold;
            color: var(--danger);
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        textarea {
            width: 100%;
            min-height: 100px;
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 6px;
            font-family: inherit;
            font-size: 1em;
            resize: vertical;
        }

        textarea:focus,
        input:focus,
        select:focus {
            outline: none;
            border-color: var(--secondary);
        }

        .completed-module {
            background: #c6f6d5;
            padding: 10px 15px;
            border-radius: 6px;
            display: inline-block;
            margin: 5px;
            font-size: 0.9em;
        }

        .skip-info {
            background: #fef5e7;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
            border-left: 4px solid var(--warning);
        }

        @media (max-width: 768px) {
            body { padding: 10px; }
            header h1 { font-size: 1.5em; }
            .module { padding: 20px; }
            .universe-comparison,
            .agent-comparison,
            .transformation-stage,
            .constructor-grid { grid-template-columns: 1fr; }
            .transform-arrow { transform: rotate(90deg); margin: 20px 0; }
        }

        :focus {
            outline: 3px solid var(--secondary);
            outline-offset: 2px;
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0,0,0,0);
            white-space: nowrap;
            border-width: 0;
        }

        @media (prefers-contrast: high) {
            :root { --border: #000000; }
            button { border: 2px solid currentColor; }
        }

        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header role="banner">
            <h1>The Physics of Possibility</h1>
            <p>Constructor Theory & The Science of "Could"</p>
            <p style="font-size: 0.9em; margin-top: 10px;">Class 7: Interactive Learning Module ‚Ä¢ 60-75 Minutes</p>
        </header>

        <div class="progress-container" role="region" aria-label="Learning progress">
            <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                <div class="progress-fill" id="progressFill">0%</div>
            </div>
            <div id="completedModules" aria-live="polite"></div>
        </div>

        <!-- Module 0: Introduction -->
        <section class="module active" id="module0" role="region" aria-labelledby="module0-title">
            <h2 id="module0-title">Introduction: The Trajectory Trap</h2>
            
            <div class="skip-info" role="note">
                <strong>üìö Transition:</strong> Module I (Hardware/Biology) ‚Üí Module II (Software/Physics)
                <ul style="margin: 10px 0 0 20px;">
                    <li><strong>Classes 1-6:</strong> Biology, brain, stress, entropy</li>
                    <li><strong>Class 7:</strong> Physics of what's <em>possible</em>, not just what happens</li>
                    <li><strong>Shift:</strong> From trajectories to counterfactuals</li>
                </ul>
            </div>

            <div class="learning-objective" role="note">
                <strong>Learning Objective:</strong> Understand Constructor Theory's shift from "what will happen" (trajectories) to "what could happen" (counterfactuals), establishing the physical basis for agency and ethics.
            </div>

            <p>Module I established you are a BROA+ (Biocognitive Repair-Oriented Agent)‚Äîa localized region of low entropy maintaining your Identity Kernel against dissolution.</p>

            <p>But biology is just chemistry, and chemistry is just physics. And here we hit a wall: <strong>The Problem of the Clockwork Universe</strong>.</p>

            <h3>Standard Physics = No Choice</h3>

            <p>Traditional physics teaches:</p>
            <ul style="margin: 10px 0 10px 30px; line-height: 1.8;">
                <li><strong>Initial Conditions:</strong> State of system at time t‚ÇÄ (position, velocity of billiard ball)</li>
                <li><strong>Laws of Motion:</strong> Equations dictating how state evolves (F=ma)</li>
            </ul>

            <p>If this is all there is, the future is <strong>completely determined</strong> by the past. The billiard ball has no "choice." It has a trajectory. If the universe is nothing but trajectories, then <strong>"ethics" is a delusion</strong>. You don't "choose" kindness‚Äîyour atoms just follow paths set by the Big Bang.</p>

            <div class="key-concept">
                <div class="key-concept-title">David Hume's Is-Ought Problem</div>
                Physics describes <strong>what is</strong> (atoms moving). It cannot describe <strong>what ought to be</strong>. Standard physics has no room for "should," "could," or "possibility."
            </div>

            <h3>The Opening: Constructor Theory</h3>

            <p>Physicists <strong>David Deutsch</strong> and <strong>Chiara Marletto</strong> propose a new mode of explanation: <strong>Constructor Theory</strong>.</p>

            <p>They argue the most fundamental laws are not about <em>what will happen</em>, but about <strong>what is possible and what is impossible, and why</strong>.</p>

            <div class="key-concept">
                <div class="key-concept-title">The Paradigm Shift</div>
                From <strong>trajectories</strong> (deterministic paths) to <strong>counterfactuals</strong> (space of possibility). This shift is the physical basis of agency. It's the foundation of Information Age ethics.
            </div>

            <div class="reading-connection">
                Review Part I (pages 1-2) and Deutsch's <em>The Beginning of Infinity</em> Chapter 1 on the reach of explanations.
            </div>

            <div class="checkpoint">
                <div class="checkpoint-title">‚úì Check Your Understanding</div>
                <p><strong>Before continuing:</strong> Why does standard physics make ethics impossible? What changes with Constructor Theory?</p>
                <textarea id="checkpoint0" aria-label="Your response" placeholder="Type your reflection here..."></textarea>
            </div>

            <div class="navigation">
                <button disabled>‚Üê Previous</button>
                <button onclick="nextModule()" class="primary">Next: Counterfactuals ‚Üí</button>
            </div>
        </section>

        <!-- Module 1: Counterfactuals -->
        <section class="module" id="module1" role="region" aria-labelledby="module1-title">
            <h2 id="module1-title">Part I: Counterfactuals - The Physics of "Could"</h2>
            
            <div class="learning-objective" role="note">
                <strong>Learning Objective:</strong> Understand counterfactuals (what could happen) as fundamental to physics, not just trajectories (what does happen). Experience the difference between deterministic and possibility-based thinking.
            </div>

            <p>In standard physics, a <strong>counterfactual</strong> is irrelevant. If a rock rolls down a hill, it doesn't matter that it <em>could have</em> rolled left if the wind blew harder. It didn't. Only what actually occurred matters.</p>

            <p><strong>Constructor Theory flips this.</strong> It says physical properties are <em>defined by counterfactuals</em>.</p>

            <div class="interactive-section" role="application" aria-label="Trajectory vs counterfactual comparison">
                <h3>Interactive: Two Ways of Understanding Reality</h3>

                <div class="universe-comparison">
                    <div class="universe-view" style="background: #e2e8f0;">
                        <h4>‚öôÔ∏è Standard Physics: Trajectory</h4>
                        <p style="font-size: 0.9em; margin-bottom: 15px;">The billiard ball follows ONE predetermined path</p>
                        <div class="trajectory-canvas" id="trajectoryCanvas">
                            <div class="ball" id="trajectoryBall" style="left: 10px; top: 90px;"></div>
                            <svg style="position: absolute; width: 100%; height: 100%; pointer-events: none;">
                                <path d="M 20 100 Q 150 50 280 100" stroke="rgba(255,255,255,0.3)" stroke-width="2" fill="none" stroke-dasharray="5,5"/>
                            </svg>
                        </div>
                        <button onclick="animateTrajectory()" style="margin-top: 10px; width: 100%;">Animate Trajectory</button>
                        <p style="margin-top: 10px; font-size: 0.85em; font-style: italic;">Given initial conditions, only this path exists. No choice, no agency, no ethics.</p>
                    </div>

                    <div class="universe-view" style="background: linear-gradient(135deg, #e6f2ff, #f0e6ff);">
                        <h4>‚ú® Constructor Theory: Counterfactuals</h4>
                        <p style="font-size: 0.9em; margin-bottom: 15px;">What transformations are POSSIBLE?</p>
                        <div class="possibility-space">
                            <div class="possibility-bubble" onclick="selectPossibility(this, 'Left')">Roll Left</div>
                            <div class="possibility-bubble" onclick="selectPossibility(this, 'Right')">Roll Right</div>
                            <div class="possibility-bubble" onclick="selectPossibility(this, 'Stop')">Stop Here</div>
                            <div class="possibility-bubble" onclick="selectPossibility(this, 'Spin')">Spin in Place</div>
                            <div class="possibility-bubble" onclick="selectPossibility(this, 'Fast')">Speed Up</div>
                            <div class="possibility-bubble" onclick="selectPossibility(this, 'Slow')">Slow Down</div>
                        </div>
                        <p id="possibilityChoice" style="margin-top: 10px; font-size: 0.85em; font-style: italic; text-align: center;">Click bubbles to explore possibilities</p>
                    </div>
                </div>
            </div>

            <h3>Key Definitions</h3>

            <div style="background: white; padding: 20px; border-radius: 8px; margin: 20px 0;">
                <ul style="line-height: 2;">
                    <li><strong>Impossible:</strong> Task forbidden by laws of physics (creating energy from nothing, faster-than-light travel)</li>
                    <li><strong>Possible:</strong> Task that creates transformation without violating physical laws, <em>provided requisite knowledge exists</em></li>
                </ul>
            </div>

            <div class="key-concept">
                <div class="key-concept-title">The Iron Atoms Example</div>
                <strong>Question:</strong> Can a pile of iron atoms become a 2024 Toyota Camry?<br><br>
                <strong>Standard Physics:</strong> "Not forbidden, but probability is so low it's effectively zero."<br>
                <strong>Constructor Theory:</strong> "Yes, if a factory and engineers (Constructors) intervene."<br><br>
                The difference between pile staying pile (trajectory) and becoming car (transformation) is the presence of a <strong>Constructor</strong>.
            </div>

            <div class="reading-connection">
                Review Part II (page 2) on counterfactuals and Marletto's <em>The Science of Can and Can't</em>.
            </div>

            <div class="checkpoint">
                <div class="checkpoint-title">‚úì Check Your Understanding</div>
                <p>Think of something you did today. In trajectory thinking: "I had no choice." In counterfactual thinking: What were the possibilities? What made one actual?</p>
                <textarea id="checkpoint1" aria-label="Your counterfactual analysis" placeholder="Analyze a decision through both lenses..."></textarea>
            </div>

            <div class="navigation">
                <button onclick="prevModule()">‚Üê Previous</button>
                <button onclick="nextModule()" class="primary">Next: Constructors ‚Üí</button>
            </div>
        </section>

        <!-- Module 2: Constructor vs Reactant -->
        <section class="module" id="module2" role="region" aria-labelledby="module2-title">
            <h2 id="module2-title">Part II: Constructor vs. Reactant</h2>
            
            <div class="learning-objective" role="note">
                <strong>Learning Objective:</strong> Understand the difference between a Constructor (causes transformation repeatedly without degrading) and a Reactant (transforms once, then exhausts itself). Apply this to ethical agency.
            </div>

            <div style="background: #e6fffa; padding: 20px; border-radius: 8px; margin: 20px 0;">
                <h4 style="color: var(--primary); margin-bottom: 10px;">The Definition of a Constructor</h4>
                <p>A <strong>Constructor</strong> is an entity that can cause a specific physical transformation to occur, <strong>while retaining the capacity to cause it again</strong>.</p>
            </div>

            <h3>Chemical Reaction Analogy</h3>

            <div class="interactive-section agent-comparison" role="application" aria-label="Constructor vs reactant comparison">
                <div class="agent-card reactant">
                    <div class="agent-icon">üí•</div>
                    <h4>REACTANT</h4>
                    <p style="margin: 15px 0; font-size: 0.9em;">Mix Acid + Base ‚Üí Explosion ‚Üí Salt + Water</p>
                    <p style="font-weight: bold; margin-bottom: 10px;">The original agents are GONE</p>
                    
                    <div class="agent-capacity">
                        <strong>Transformation Capacity:</strong>
                        <div class="capacity-bar">
                            <div class="capacity-fill" style="width: 100%; background: linear-gradient(90deg, #f56565, #e53e3e);">
                                100% (Once)
                            </div>
                        </div>
                        <div class="capacity-bar" style="margin-top: 10px;">
                            <div class="capacity-fill" style="width: 0%; background: var(--text-light);">
                                0% (After)
                            </div>
                        </div>
                    </div>
                    
                    <p style="margin-top: 15px; font-size: 0.85em;"><strong>Constructor Capacity:</strong> LOW. One transformation, then exhaustion.</p>
                </div>

                <div class="agent-card constructor">
                    <div class="agent-icon">üß™</div>
                    <h4>CONSTRUCTOR (Catalyst)</h4>
                    <p style="margin: 15px 0; font-size: 0.9em;">Add Enzyme ‚Üí Transformation ‚Üí Enzyme unchanged</p>
                    <p style="font-weight: bold; margin-bottom: 10px;">Ready to cause transformation AGAIN</p>
                    
                    <div class="agent-capacity">
                        <strong>Transformation Capacity:</strong>
                        <div class="capacity-bar">
                            <div class="capacity-fill" style="width: 100%; background: linear-gradient(90deg, #48bb78, #38a169);">
                                100% (1st)
                            </div>
                        </div>
                        <div class="capacity-bar" style="margin-top: 10px;">
                            <div class="capacity-fill" style="width: 100%; background: linear-gradient(90deg, #48bb78, #38a169);">
                                100% (2nd)
                            </div>
                        </div>
                        <div class="capacity-bar" style="margin-top: 10px;">
                            <div class="capacity-fill" style="width: 100%; background: linear-gradient(90deg, #48bb78, #38a169);">
                                100% (3rd...)
                            </div>
                        </div>
                    </div>
                    
                    <p style="margin-top: 15px; font-size: 0.85em;"><strong>Constructor Capacity:</strong> SUSTAINABLE. Infinite transformations without degradation.</p>
                </div>
            </div>

            <h3>The Surgeon Scenario</h3>

            <p>This distinction is the single most important mental model for your professional life.</p>

            <div style="display: grid; gap: 20px; margin: 20px 0;">
                <div style="background: #fed7d7; padding: 20px; border-radius: 8px; border-left: 4px solid var(--danger);">
                    <h4 style="color: var(--danger); margin-bottom: 10px;">The Reactant Surgeon</h4>
                    <p>Deeply empathetic. Stays awake 48 hours because she "cares so much." Stops eating. Absorbs every patient's trauma. By hour 50:</p>
                    <ul style="margin: 10px 0 0 20px;">
                        <li>Hands shaking</li>
                        <li>Cortisol spiking (PFC destroyed)</li>
                        <li>Makes mistake ‚Üí patient dies</li>
                        <li>Burns out, quits medicine</li>
                    </ul>
                    <p style="margin-top: 10px; font-weight: bold;">Optimized for feeling (intensity)</p>
                </div>

                <div style="background: #c6f6d5; padding: 20px; border-radius: 8px; border-left: 4px solid var(--success);">
                    <h4 style="color: var(--success); margin-bottom: 10px;">The Constructor Surgeon</h4>
                    <p>Cares just as much, but understands physics of her own machinery. She:</p>
                    <ul style="margin: 10px 0 0 20px;">
                        <li>Sleeps (maintains PFC)</li>
                        <li>Eats (maintains energy)</li>
                        <li>Uses BioBonds (processes trauma)</li>
                        <li>Performs surgery ‚Üí saves patient ‚Üí ready for next one</li>
                    </ul>
                    <p style="margin-top: 10px; font-weight: bold;">Optimized for capacity (sustainability)</p>
                </div>
            </div>

            <div class="key-concept">
                <div class="key-concept-title">Code Integrity</div>
                The practice of prioritizing maintenance of your own Coherent Information Blueprint (CIB) to ensure long-term agency. It's the refusal to let external entropy overwrite internal order.
            </div>

            <div class="reading-connection">
                Review Part II (pages 2-3) and Part V (pages 4-5) on Constructor definition and Code Integrity.
            </div>

            <div class="checkpoint">
                <div class="checkpoint-title">‚úì Check Your Understanding</div>
                <p>Identify a time you acted as a Reactant (sacrificed wellbeing for result). What was the long-term cost to your Constructor capacity?</p>
                <textarea id="checkpoint2" aria-label="Your reactant experience" placeholder="Describe when you burned yourself up..."></textarea>
            </div>

            <div class="navigation">
                <button onclick="prevModule()">‚Üê Previous</button>
                <button onclick="nextModule()" class="primary">Next: Knowledge ‚Üí</button>
            </div>
        </section>

        <!-- Module 3: Knowledge as Physical -->
        <section class="module" id="module3" role="region" aria-labelledby="module3-title">
            <h2 id="module3-title">Part III: Knowledge as Physical</h2>
            
            <div class="learning-objective" role="note">
                <strong>Learning Objective:</strong> Understand knowledge as information with causal power‚Äînot abstract belief, but physical Constructor enabling transformations.
            </div>

            <p>If laws of physics <em>allow</em> a transformation (curing disease, ending war, building shelter), but that transformation is not happening spontaneously, what's missing?</p>

            <p><strong>The missing variable is Knowledge.</strong></p>

            <div class="key-concept">
                <div class="key-concept-title">Knowledge in Constructor Theory</div>
                Knowledge is not just abstract "belief" in your head. <strong>Knowledge is information that has causal power.</strong> It is information that acts as a Constructor.
            </div>

            <div class="interactive-section transformation-demo" role="application" aria-label="Knowledge transformation demonstration">
                <h3>Interactive: Knowledge Enables Transformation</h3>
                <p>Watch how knowledge changes what's possible:</p>

                <div class="knowledge-input">
                    <strong>Select the knowledge (CIB) you possess:</strong>
                    <div class="knowledge-options">
                        <div class="knowledge-option" onclick="selectKnowledge(this, 'none')" data-knowledge="none">
                            <strong>No Knowledge</strong>
                            <p style="font-size: 0.85em; margin-top: 5px;">Just raw materials</p>
                        </div>
                        <div class="knowledge-option" onclick="selectKnowledge(this, 'gene')" data-knowledge="gene">
                            <strong>Genetic Knowledge</strong>
                            <p style="font-size: 0.85em; margin-top: 5px;">DNA sequence (gene)</p>
                        </div>
                        <div class="knowledge-option" onclick="selectKnowledge(this, 'recipe')" data-knowledge="recipe">
                            <strong>Culinary Knowledge</strong>
                            <p style="font-size: 0.85em; margin-top: 5px;">Recipe with instructions</p>
                        </div>
                        <div class="knowledge-option" onclick="selectKnowledge(this, 'ethical')" data-knowledge="ethical">
                            <strong>Ethical Knowledge</strong>
                            <p style="font-size: 0.85em; margin-top: 5px;">Cooperative protocols (CIB)</p>
                        </div>
                    </div>
                </div>

                <div class="transformation-stage">
                    <div class="state-box before">
                        <div style="font-size: 2.5em; margin-bottom: 10px;" id="beforeIcon">üî¥</div>
                        <strong id="beforeState">Raw Materials</strong>
                        <p id="beforeDesc" style="font-size: 0.85em; margin-top: 8px;">Disordered atoms/primates</p>
                    </div>

                    <div class="transform-arrow">
                        <span id="transformSymbol">‚ùì</span>
                    </div>

                    <div class="state-box after" style="opacity: 0.3;">
                        <div style="font-size: 2.5em; margin-bottom: 10px;" id="afterIcon">‚ùî</div>
                        <strong id="afterState">No Transformation</strong>
                        <p id="afterDesc" style="font-size: 0.85em; margin-top: 8px;">Without knowledge, nothing changes</p>
                    </div>
                </div>

                <div id="transformFeedback" style="margin-top: 20px; padding: 15px; background: #fef5e7; border-radius: 8px; display: none;"></div>
            </div>

            <h3>Examples of Knowledge as Constructor</h3>

            <ul style="margin: 15px 0 15px 30px; line-height: 2;">
                <li><strong>A gene</strong> is knowledge. It constructs an organism from amino acids.</li>
                <li><strong>A recipe</strong> is knowledge. It constructs a cake from flour and eggs.</li>
                <li><strong>An ethical code</strong> is knowledge. It constructs a cooperative society from individual primates.</li>
            </ul>

            <div class="key-concept">
                <div class="key-concept-title">Evil as Lack of Knowledge</div>
                When we look at history‚Äîwars, genocides, failures of cooperation‚Äîwe attribute them to "malice" or "sin." Through Constructor Theory, we view them as <strong>failure of construction</strong>. Agents lacked the specific CIB required to transform conflict into cooperation. Peace was <em>possible</em>, but they lacked the software to execute the task.
            </div>

            <p style="margin: 20px 0;">Therefore, acquiring ethical knowledge‚Äîexpanding your CIB‚Äîis not just "personal growth." It's <strong>increasing the Constructor Capacity of the universe</strong>. You're installing drivers necessary to render a better reality.</p>

            <div class="reading-connection">
                Review Part III (page 3) on knowledge as physical phase transition.
            </div>

            <div class="checkpoint">
                <div class="checkpoint-title">‚úì Check Your Understanding</div>
                <p>What's a transformation you want to cause (personal or societal)? What knowledge (CIB) would you need to act as Constructor?</p>
                <textarea id="checkpoint3" aria-label="Your transformation analysis" placeholder="Identify transformation and required knowledge..."></textarea>
            </div>

            <div class="navigation">
                <button onclick="prevModule()">‚Üê Previous</button>
                <button onclick="nextModule()" class="primary">Next: Universal Constructor ‚Üí</button>
            </div>
        </section>

        <!-- Module 4: Universal Constructor -->
        <section class="module" id="module4" role="region" aria-labelledby="module4-title">
            <h2 id="module4-title">Part IV: The Universal Constructor</h2>
            
            <div class="learning-objective" role="note">
                <strong>Learning Objective:</strong> Understand humans as Universal Constructors‚Äîcapable of performing any physically possible task if given the right knowledge. Recognize the ethical weight of this capacity.
            </div>

            <p>In computer science: <strong>Universal Turing Machine</strong> can compute <em>any</em> computable function if given right software.</p>

            <p>In physics: Deutsch proposes <strong>Universal Constructor</strong>‚Äîa machine that can perform <em>any</em> physically possible task if given right knowledge.</p>

            <div class="key-concept">
                <div class="key-concept-title">Humans Are Universal Constructors</div>
                We are the closest thing to Universal Constructors in the known universe. Our Identity Kernel is programmable‚Äîwe can rewrite our own CIBs through neuroplasticity.
            </div>

            <div class="interactive-section constructor-grid" role="application" aria-label="Constructor capabilities comparison">
                <div class="constructor-entity" style="border-color: var(--warning);">
                    <div style="font-size: 2.5em; text-align: center; margin-bottom: 10px;">ü¶´</div>
                    <h4>Beaver (Specific Constructor)</h4>
                    <div class="capability-list">
                        <div class="capability-item">‚úì Build dam</div>
                        <div class="capability-item">‚úì Gnaw trees</div>
                        <div class="capability-item">‚úì Swim</div>
                        <div class="capability-locked">‚úó Build skyscraper</div>
                        <div class="capability-locked">‚úó Write poetry</div>
                        <div class="capability-locked">‚úó Create justice system</div>
                    </div>
                    <p style="margin-top: 10px; font-size: 0.85em; font-style: italic;">Fixed capabilities. Cannot install new knowledge.</p>
                </div>

                <div class="constructor-entity" style="border-color: var(--teal);">
                    <div style="font-size: 2.5em; text-align: center; margin-bottom: 10px;">ü¶†</div>
                    <h4>Bacterium (Specific Constructor)</h4>
                    <div class="capability-list">
                        <div class="capability-item">‚úì Build protein</div>
                        <div class="capability-item">‚úì Replicate</div>
                        <div class="capability-item">‚úì Metabolize</div>
                        <div class="capability-locked">‚úó Build spaceship</div>
                        <div class="capability-locked">‚úó Compose music</div>
                        <div class="capability-locked">‚úó Design institutions</div>
                    </div>
                    <p style="margin-top: 10px; font-size: 0.85em; font-style: italic;">Biochemical Constructor only. Cannot learn new tasks.</p>
                </div>

                <div class="constructor-entity" style="border-color: var(--success); background: linear-gradient(135deg, #c6f6d5, #9ae6b4);">
                    <div style="font-size: 2.5em; text-align: center; margin-bottom: 10px;">üßë</div>
                    <h4>Human (Universal Constructor)</h4>
                    <div class="capability-list">
                        <div class="capability-item">‚úì Build dam</div>
                        <div class="capability-item">‚úì Build skyscraper</div>
                        <div class="capability-item">‚úì Build spaceship</div>
                        <div class="capability-item">‚úì Write poem</div>
                        <div class="capability-item">‚úì Create justice system</div>
                        <div class="capability-item">‚úì Cure disease</div>
                        <div class="capability-item">‚úì Build nuclear weapon</div>
                        <div class="capability-item">‚úì <strong>Install ANY knowledge</strong></div>
                    </div>
                    <p style="margin-top: 10px; font-size: 0.85em; font-weight: bold;">Programmable kernel. Can instantiate any physically possible transformation.</p>
                </div>
            </div>

            <h3>The Ethical Weight</h3>

            <p>This brings us to the central ethical tension of the Information Age. <strong>If we are Universal Constructors, we are responsible for the tasks we choose to execute.</strong></p>

            <div style="background: #fef5e7; padding: 20px; border-radius: 8px; margin: 20px 0;">
                <h4 style="color: var(--primary); margin-bottom: 10px;">The Is-Ought Bridge</h4>
                <ol style="margin-left: 20px; line-height: 2;">
                    <li><strong>Is:</strong> Universe contains raw materials and laws of physics</li>
                    <li><strong>Is:</strong> You are Universal Constructor capable of infinite configurations</li>
                    <li><strong>Ought:</strong> Therefore, preservation of capacity to create knowledge is the fundamental good</li>
                </ol>
            </div>

            <div class="key-concept">
                <div class="key-concept-title">Destroying Constructors</div>
                If you destroy a Constructor (person, culture, library), you're not just destroying "what is." You're destroying <strong>"what could be."</strong> You're pruning the counterfactuals of the universe. You're making certain futures physically impossible.
            </div>

            <div class="reading-connection">
                Review Part IV (pages 3-4) on the Universal Constructor and the Is-Ought bridge.
            </div>

            <div class="checkpoint">
                <div class="checkpoint-title">‚úì Check Your Understanding</div>
                <p>What makes humans different from beavers and bacteria? Why does being a Universal Constructor create moral responsibility?</p>
                <textarea id="checkpoint4" aria-label="Your universal constructor analysis" placeholder="Explain the ethical weight..."></textarea>
            </div>

            <div class="navigation">
                <button onclick="prevModule()">‚Üê Previous</button>
                <button onclick="nextModule()" class="primary">Next: Code Integrity ‚Üí</button>
            </div>
        </section>

        <!-- Module 5: Code Integrity & Optimism -->
        <section class="module" id="module5" role="region" aria-labelledby="module5-title">
            <h2 id="module5-title">Part V: Code Integrity & The Principle of Optimism</h2>
            
            <div class="learning-objective" role="note">
                <strong>Learning Objective:</strong> Track your own Code Integrity (maintaining Constructor capacity) and understand the Principle of Optimism (all evils are caused by lack of knowledge).
            </div>

            <h3>Code Integrity Meter</h3>

            <p>Your primary ethical obligation is to <strong>maintain the integrity of your Identity Kernel</strong>. You must remain a Constructor.</p>

            <div class="interactive-section integrity-tracker" role="application" aria-label="Code integrity tracker">
                <p><strong>Make choices and watch your Code Integrity change:</strong></p>

                <div class="action-buttons">
                    <div class="action-button degrading" onclick="modifyIntegrity(-15, 'martyr')" tabindex="0" role="button">
                        <div style="font-size: 2em; margin-bottom: 5px;">üî•</div>
                        <strong>Martyr Choice</strong>
                        <p style="font-size: 0.85em; margin-top: 5px;">Burn yourself up to help others</p>
                        <p style="font-size: 0.85em; color: var(--danger);">-15% integrity</p>
                    </div>

                    <div class="action-button degrading" onclick="modifyIntegrity(-10, 'overwork')" tabindex="0" role="button">
                        <div style="font-size: 2em; margin-bottom: 5px;">üò∞</div>
                        <strong>Chronic Overwork</strong>
                        <p style="font-size: 0.85em; margin-top: 5px;">No sleep, no boundaries</p>
                        <p style="font-size: 0.85em; color: var(--danger);">-10% integrity</p>
                    </div>

                    <div class="action-button maintaining" onclick="modifyIntegrity(10, 'boundaries')" tabindex="0" role="button">
                        <div style="font-size: 2em; margin-bottom: 5px;">üõ°Ô∏è</div>
                        <strong>Set Boundaries</strong>
                        <p style="font-size: 0.85em; margin-top: 5px;">Protect your capacity</p>
                        <p style="font-size: 0.85em; color: var(--success);">+10% integrity</p>
                    </div>

                    <div class="action-button maintaining" onclick="modifyIntegrity(15, 'restore')" tabindex="0" role="button">
                        <div style="font-size: 2em; margin-bottom: 5px;">üîÑ</div>
                        <strong>Active Restoration</strong>
                        <p style="font-size: 0.85em; margin-top: 5px;">Sleep, BioBond, repair</p>
                        <p style="font-size: 0.85em; color: var(--success);">+15% integrity</p>
                    </div>
                </div>

                <div class="integrity-meter">
                    <h4 style="margin-bottom: 10px;">Your Code Integrity:</h4>
                    <div class="integrity-bar">
                        <div class="integrity-fill" id="integrityFill" style="width: 80%; background: linear-gradient(90deg, #48bb78, #38a169);">80% Intact</div>
                    </div>
                    <div id="integrityStatus" style="margin-top: 10px; font-size: 0.9em;">
                        Your CIB is intact. You can cause transformations repeatedly. You are a Constructor.
                    </div>
                </div>
            </div>

            <h3>The Principle of Optimism</h3>

            <p>David Deutsch proposes a principle derived from Constructor Theory that serves as powerful ethical maxim:</p>

            <div class="key-concept">
                <div class="key-concept-title">The Principle of Optimism</div>
                <strong>"All evils are caused by a lack of knowledge."</strong><br><br>
                If a problem is not forbidden by laws of physics, then it is <strong>soluble</strong>. The only barrier is the knowledge (CIB) required to execute the solution.
            </div>

            <div class="interactive-section problem-analyzer" role="application" aria-label="Problem solubility analyzer">
                <h3>Interactive: Is This Problem Soluble?</h3>
                
                <div class="problem-input">
                    <label for="problemName"><strong>Name the problem:</strong></label>
                    <input type="text" id="problemName" placeholder="e.g., Climate change, poverty, disease..." aria-label="Problem name">
                </div>

                <div class="problem-input" style="margin-top: 15px;">
                    <label for="problemDesc"><strong>Does it violate the laws of physics?</strong></label>
                    <select id="problemPhysics" aria-label="Physics violation">
                        <option value="">Select...</option>
                        <option value="violates">Yes - It requires faster-than-light travel, creating energy from nothing, etc.</option>
                        <option value="possible">No - It's just energy/resource/coordination management</option>
                    </select>
                </div>

                <button onclick="analyzeProblem()" style="margin-top: 15px; width: 100%;" class="success">Analyze Problem</button>

                <div id="analysisResult" class="analysis-result"></div>
            </div>

            <div style="background: #e6fffa; padding: 20px; border-radius: 8px; margin: 20px 0;">
                <h4 style="color: var(--primary); margin-bottom: 10px;">Implications</h4>
                <ul style="margin-left: 20px; line-height: 2;">
                    <li>Climate change? <strong>Soluble.</strong> (Energy management)</li>
                    <li>Poverty? <strong>Soluble.</strong> (Resource distribution)</li>
                    <li>Disease? <strong>Soluble.</strong> (Biological repair)</li>
                </ul>
                <p style="margin-top: 15px;">This transforms ethical agent from passive observer of tragedy into <strong>active engineer of solutions</strong>. We must keep the "Open Society" open‚Äîclosed societies (authoritarianism, dogmatism) stop creation of new knowledge, sealing off escape routes.</p>
            </div>

            <div class="reading-connection">
                Review Part V (pages 4-5) on Code Integrity and Part VI (page 5) on the Principle of Optimism.
            </div>

            <div class="checkpoint">
                <div class="checkpoint-title">‚úì Check Your Understanding</div>
                <p>How does the concept of "Code Integrity" challenge the traditional notion that "selflessness" is the highest virtue?</p>
                <textarea id="checkpoint5" aria-label="Your code integrity reflection" placeholder="Challenge traditional virtue ethics..."></textarea>
            </div>

            <div class="navigation">
                <button onclick="prevModule()">‚Üê Previous</button>
                <button onclick="nextModule()" class="primary">Next: Dashboard ‚Üí</button>
            </div>
        </section>

        <!-- Module 6: Constructor's Dashboard -->
        <section class="module" id="module6" role="region" aria-labelledby="module6-title">
            <h2 id="module6-title">Part VI: The Constructor's Dashboard</h2>
            
            <div class="learning-objective" role="note">
                <strong>Learning Objective:</strong> Apply Constructor Theory to practical decision-making through the CIB Feasibility Check‚Äîa four-step framework for ethical action.
            </div>

            <p>How do you apply this high-level physics to your daily life as student and future professional? You treat decision-making as a <strong>Constructor's Dashboard</strong>.</p>

            <div class="interactive-section dashboard" role="application" aria-label="Constructor's dashboard tool">
                <h3>Interactive: Run the CIB Feasibility Check</h3>
                <p>Before you act, run your decision through this four-step framework:</p>

                <div class="dashboard-checklist">
                    <div class="dashboard-item">
                        <h4>1. THE TASK: What transformation are you trying to achieve?</h4>
                        <p style="font-size: 0.9em; margin: 10px 0;">Vague: "Help the world" (entropy‚Äîno definition)<br>
                        Specific: "Reduce recidivism in local juvenile detention" (target)</p>
                        <textarea id="dashboardTask" placeholder="Define your specific transformation..." aria-label="Task definition"></textarea>
                    </div>

                    <div class="dashboard-item">
                        <h4>2. THE PHYSICS: Is this transformation possible?</h4>
                        <p style="font-size: 0.9em; margin: 10px 0;">Does it violate laws of physics or hard constraints?</p>
                        <select id="dashboardPhysics" aria-label="Physics check">
                            <option value="">Select...</option>
                            <option value="impossible">Impossible - Violates physical law</option>
                            <option value="possible">Possible - Allowed by physics</option>
                        </select>
                    </div>

                    <div class="dashboard-item">
                        <h4>3. THE KNOWLEDGE: Do you possess the CIB to act as Constructor?</h4>
                        <p style="font-size: 0.9em; margin: 10px 0;">Do you have the skills/data to cause this transformation?</p>
                        <select id="dashboardKnowledge" aria-label="Knowledge check">
                            <option value="">Select...</option>
                            <option value="no">No - I lack the necessary CIB</option>
                            <option value="partial">Partial - I have some knowledge</option>
                            <option value="yes">Yes - I have the required CIB</option>
                        </select>
                    </div>

                    <div class="dashboard-item">
                        <h4>4. THE COST: Will this turn you into a Reactant?</h4>
                        <p style="font-size: 0.9em; margin: 10px 0;">Will this destroy your ability to function tomorrow?</p>
                        <select id="dashboardCost" aria-label="Cost check">
                            <option value="">Select...</option>
                            <option value="destructive">Destructive - I'll burn out</option>
                            <option value="sustainable">Sustainable - I can maintain capacity</option>
                            <option value="needs-redesign">Needs redesign - Must distribute load</option>
                        </select>
                    </div>
                </div>

                <button onclick="runDashboard()" class="success" style="width: 100%; padding: 15px; font-size: 1.1em;">
                    Run Constructor's Dashboard
                </button>

                <div id="dashboardResult" class="dashboard-result"></div>
            </div>

            <div class="key-concept">
                <div class="key-concept-title">The Decision Framework</div>
                <ul style="margin-top: 10px; line-height: 2;">
                    <li><strong>If Knowledge = Yes & Cost = Sustainable:</strong> Proceed</li>
                    <li><strong>If Knowledge = No:</strong> Your duty is not to act, but to <strong>learn</strong>. Acting without knowledge makes you chaotic variable.</li>
                    <li><strong>If Cost = Destructive:</strong> Redesign approach. Perhaps build BioBond/team to distribute load.</li>
                </ul>
            </div>

            <div class="reading-connection">
                Review Part VII (pages 5-6) on practical application of the Constructor's Dashboard and the Summary.
            </div>

            <h3>Summary of Class 7</h3>

            <div style="background: #c6f6d5; padding: 20px; border-radius: 12px; margin: 30px 0;">
                <ul style="line-height: 2;">
                    <li><strong>From Trajectory to Possibility:</strong> Reject clockwork universe. Live in universe of counterfactuals‚Äîwhat <em>could</em> happen matters.</li>
                    <li><strong>Constructor:</strong> Entity that causes transformation while retaining ability to cause it again.</li>
                    <li><strong>Reactant vs. Catalyst:</strong> Don't burn yourself up. Sustainable ethics requires acting as catalyst, not fuel.</li>
                    <li><strong>Knowledge is Physical:</strong> Good intentions insufficient. Need specific CIB to instantiate good.</li>
                    <li><strong>Duty of Optimism:</strong> Problems are soluble. Our job: create knowledge to solve them.</li>
                </ul>
            </div>

            <div class="checkpoint">
                <div class="checkpoint-title">‚úì Check Your Understanding</div>
                <p>Use the Constructor's Dashboard on a real decision you're facing. What did you learn?</p>
                <textarea id="checkpoint6" aria-label="Your dashboard application" placeholder="Apply the four-step framework..." style="min-height: 100px;"></textarea>
            </div>

            <div class="navigation">
                <button onclick="prevModule()">‚Üê Previous</button>
                <button onclick="nextModule()" class="primary">Next: P-adic Identity Builder ‚Üí</button>
            </div>
        </section>

        <!-- Module 7: P-adic Identity Builder (NEW!) -->
        <section class="module" id="module7" role="region" aria-labelledby="module7-title">
            <h2 id="module7-title">Advanced: The P-adic Identity Builder</h2>
            
            <div class="learning-objective" role="note">
                <strong>üéØ Learning Objective:</strong> Understand that your identity has hierarchical structure (p-adic expansion), and that changing root values requires crossing larger geometric distance than changing surface behaviors.
            </div>

            <div style="background: #fef5e7; border-left: 4px solid #ed8936; padding: 15px; margin: 20px 0; border-radius: 4px;">
                <strong>üî¨ Advanced Content:</strong> This module introduces the mathematical substrate underlying CIB theory. Don't worry if the formulas look intimidating‚Äîfocus on the visual builder and the core insight about value hierarchy.
            </div>

            <p>In Class 1, you learned that identity complexity (N) determines how much energy you need. But what IS that complexity? It's not just "how many values you have"‚Äîit's about the <strong>hierarchical structure</strong> of those values.</p>

            <h3>The P-adic Structure of Identity</h3>

            <p>Your identity isn't flat. It's structured like a tree, with roots, trunk, and branches. Mathematically, this is a <strong>p-adic expansion</strong>:</p>

            <div class="formula" style="background: #f7fafc; padding: 15px; border-radius: 6px; margin: 15px 0; text-align: center; font-family: 'Courier New', monospace;">
                Œ®<sub>identity</sub> = c‚ÇÄ¬∑p‚Å∞ + c‚ÇÅ¬∑p¬π + c‚ÇÇ¬∑p¬≤ + ... + c<sub>N</sub>¬∑p<sup>N</sup>
            </div>

            <p style="text-align: center; margin: 20px 0;">Where each coefficient (c<sub>n</sub>) represents a value at a specific depth level</p>

            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin: 30px 0;">
                <div style="background: #fed7d7; padding: 20px; border-radius: 12px; border: 3px solid #e53e3e;">
                    <h4 style="text-align: center; margin-bottom: 10px;">üå± ROOT (c‚ÇÄ, c‚ÇÅ)</h4>
                    <p><strong>Depth:</strong> Biological/Evolutionary</p>
                    <p style="margin-top: 10px;"><strong>Examples:</strong></p>
                    <ul style="margin: 10px 0 0 20px; line-height: 1.8;">
                        <li>"Never harm family"</li>
                        <li>"Seek safety"</li>
                        <li>"Avoid pain"</li>
                    </ul>
                    <p style="margin-top: 10px; font-style: italic; font-size: 0.9em;">Cannot be changed without trauma</p>
                </div>

                <div style="background: #feebc8; padding: 20px; border-radius: 12px; border: 3px solid #ed8936;">
                    <h4 style="text-align: center; margin-bottom: 10px;">üå≥ TRUNK (c‚ÇÇ-c‚ÇÖ)</h4>
                    <p><strong>Depth:</strong> Cultural/Social</p>
                    <p style="margin-top: 10px;"><strong>Examples:</strong></p>
                    <ul style="margin: 10px 0 0 20px; line-height: 1.8;">
                        <li>"Be honest in business"</li>
                        <li>"Respect authority"</li>
                        <li>"Work hard"</li>
                    </ul>
                    <p style="margin-top: 10px; font-style: italic; font-size: 0.9em;">Can change through enculturation</p>
                </div>

                <div style="background: #e9d8fd; padding: 20px; border-radius: 12px; border: 3px solid #805ad5;">
                    <h4 style="text-align: center; margin-bottom: 10px;">üåø EDGE (c‚ÇÜ-c‚ÇÅ‚ÇÄ)</h4>
                    <p><strong>Depth:</strong> Abstract/Philosophical</p>
                    <p style="margin-top: 10px;"><strong>Examples:</strong></p>
                    <ul style="margin: 10px 0 0 20px; line-height: 1.8;">
                        <li>"Maximize global utility"</li>
                        <li>"Apply categorical imperative"</li>
                        <li>"Reduce suffering universally"</li>
                    </ul>
                    <p style="margin-top: 10px; font-style: italic; font-size: 0.9em;">Can change through education/reflection</p>
                </div>
            </div>

            <div class="critical-insight" style="background: #fed7d7; border-left: 4px solid #f56565; padding: 15px; margin: 20px 0; border-radius: 4px;">
                <strong>‚ö†Ô∏è Key Insight:</strong>
                <p style="margin-top: 10px;">In Class 1, you saw identity <em>truncate</em> under stress (lose Edge, then Trunk, keep Root).</p>
                <p style="margin-top: 10px;">Now you'll see why: <strong>the p-adic metric makes Root values "closer together" than Edge values</strong>. When energy is scarce, the system falls back to the most tightly-clustered (cheapest to maintain) values.</p>
            </div>

            <h3>The Ultrametric Distance</h3>

            <p>The "distance" between two value systems is calculated using the <strong>p-adic ultrametric</strong>:</p>

            <div class="formula" style="background: #f7fafc; padding: 15px; border-radius: 6px; margin: 15px 0; text-align: center; font-family: 'Courier New', monospace;">
                d<sub>p</sub>(Œ®‚ÇÅ, Œ®‚ÇÇ) = p<sup>-k</sup>
            </div>

            <p style="text-align: center; margin: 20px 0;">Where k = index of first coefficient where Œ®‚ÇÅ and Œ®‚ÇÇ differ</p>

            <div style="background: white; padding: 20px; border-radius: 8px; margin: 20px 0; border: 2px solid #e2e8f0;">
                <h4>What This Means:</h4>
                <p style="margin: 10px 0;"><strong>If you differ at c‚ÇÄ (Root):</strong> d<sub>p</sub> = p‚Å∞ = 1.0 (maximum distance)</p>
                <p style="margin: 10px 0;"><strong>If you agree on Root but differ at c‚ÇÖ (Trunk):</strong> d<sub>p</sub> = p<sup>-5</sup> ‚âà 0.03 (small distance)</p>
                <p style="margin: 10px 0;"><strong>If you agree on Root + Trunk but differ at c‚ÇÅ‚ÇÄ (Edge):</strong> d<sub>p</sub> = p<sup>-10</sup> ‚âà 0.001 (tiny distance)</p>
            </div>

            <div class="key-concept" style="background: #e6fffa; border-left: 4px solid #319795; padding: 15px; margin: 20px 0; border-radius: 4px;">
                <div class="key-concept-title">Why This Matters for Ethics:</div>
                <p style="margin-top: 10px;"><strong>1. Changing your mind about philosophy (Edge) is easy:</strong> You read a new book, you update c‚ÇÅ‚ÇÄ. Small geometric jump.</p>
                <p style="margin-top: 10px;"><strong>2. Changing your cultural norms (Trunk) is hard:</strong> Requires immersion in new culture, years of practice. Medium geometric jump.</p>
                <p style="margin-top: 10px;"><strong>3. Changing your core survival instincts (Root) is nearly impossible:</strong> Would require literally rewiring your biology. Maximum geometric jump.</p>
                <p style="margin-top: 15px; font-weight: bold;">This explains why "just change your values" is thermodynamically naive. The depth of the value determines the energy cost of changing it.</p>
            </div>

            <div class="interactive-section" role="application" aria-label="P-adic identity builder tool">
                <h3>üîß Interactive: Build Your P-adic Identity</h3>

                <p style="margin-bottom: 20px;">Click on each layer to add values. Then compare your identity to alternative value systems to see the geometric distance.</p>

                <div class="padic-builder">
                    <div class="padic-layer" id="rootLayer">
                        <div class="layer-header" style="background: #fed7d7; padding: 15px; border-radius: 8px 8px 0 0; border: 3px solid #e53e3e; border-bottom: none;">
                            <h4>üå± ROOT Layer (c‚ÇÄ, c‚ÇÅ)</h4>
                            <p style="font-size: 0.9em; margin-top: 5px;">Biological/Evolutionary values - Cannot be modified</p>
                        </div>
                        <div class="layer-values" style="background: white; padding: 20px; border: 3px solid #e53e3e; border-top: none; border-radius: 0 0 8px 8px; margin-bottom: 20px;">
                            <div class="value-options">
                                <label class="value-checkbox">
                                    <input type="checkbox" name="root" value="protect_family" checked disabled>
                                    <span>Protect family/tribe</span>
                                </label>
                                <label class="value-checkbox">
                                    <input type="checkbox" name="root" value="seek_safety" checked disabled>
                                    <span>Seek safety/avoid danger</span>
                                </label>
                                <label class="value-checkbox">
                                    <input type="checkbox" name="root" value="avoid_pain" checked disabled>
                                    <span>Avoid pain/suffering</span>
                                </label>
                                <p style="margin-top: 15px; font-style: italic; color: #718096; font-size: 0.9em;">‚úì Root values are fixed (evolutionary givens)</p>
                            </div>
                        </div>
                    </div>

                    <div class="padic-layer" id="trunkLayer">
                        <div class="layer-header" style="background: #feebc8; padding: 15px; border-radius: 8px 8px 0 0; border: 3px solid #ed8936; border-bottom: none;">
                            <h4>üå≥ TRUNK Layer (c‚ÇÇ-c‚ÇÖ)</h4>
                            <p style="font-size: 0.9em; margin-top: 5px;">Cultural/Social values - Select your norms</p>
                        </div>
                        <div class="layer-values" style="background: white; padding: 20px; border: 3px solid #ed8936; border-top: none; border-radius: 0 0 8px 8px; margin-bottom: 20px;">
                            <div class="value-options">
                                <label class="value-checkbox">
                                    <input type="checkbox" name="trunk" value="honesty">
                                    <span>Be honest in business dealings</span>
                                </label>
                                <label class="value-checkbox">
                                    <input type="checkbox" name="trunk" value="authority">
                                    <span>Respect authority/hierarchy</span>
                                </label>
                                <label class="value-checkbox">
                                    <input type="checkbox" name="trunk" value="hard_work">
                                    <span>Work hard/be industrious</span>
                                </label>
                                <label class="value-checkbox">
                                    <input type="checkbox" name="trunk" value="loyalty">
                                    <span>Loyalty to organization</span>
                                </label>
                                <label class="value-checkbox">
                                    <input type="checkbox" name="trunk" value="tradition">
                                    <span>Respect tradition/customs</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="padic-layer" id="edgeLayer">
                        <div class="layer-header" style="background: #e9d8fd; padding: 15px; border-radius: 8px 8px 0 0; border: 3px solid #805ad5; border-bottom: none;">
                            <h4>üåø EDGE Layer (c‚ÇÜ-c‚ÇÅ‚ÇÄ)</h4>
                            <p style="font-size: 0.9em; margin-top: 5px;">Abstract/Philosophical values - Select your principles</p>
                        </div>
                        <div class="layer-values" style="background: white; padding: 20px; border: 3px solid #805ad5; border-top: none; border-radius: 0 0 8px 8px; margin-bottom: 20px;">
                            <div class="value-options">
                                <label class="value-checkbox">
                                    <input type="checkbox" name="edge" value="utility">
                                    <span>Maximize global utility (Utilitarian)</span>
                                </label>
                                <label class="value-checkbox">
                                    <input type="checkbox" name="edge" value="categorical">
                                    <span>Follow categorical imperative (Kantian)</span>
                                </label>
                                <label class="value-checkbox">
                                    <input type="checkbox" name="edge" value="virtue">
                                    <span>Cultivate virtuous character (Aristotelian)</span>
                                </label>
                                <label class="value-checkbox">
                                    <input type="checkbox" name="edge" value="care">
                                    <span>Prioritize care relationships</span>
                                </label>
                                <label class="value-checkbox">
                                    <input type="checkbox" name="edge" value="justice">
                                    <span>Pursue systemic justice (Rawlsian)</span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <button onclick="calculatePadicDistance()" class="success" style="width: 100%; padding: 15px; font-size: 1.1em; margin-top: 20px;">
                    Calculate Distance to Alternative Value Systems
                </button>

                <div id="padicResult" style="display: none; margin-top: 30px;"></div>
            </div>

            <div class="reading-connection" style="background: #fef5e7; border-left: 4px solid #ed8936; padding: 15px; margin: 20px 0; border-radius: 4px;">
                <strong>üìñ Advanced Reading:</strong> This module connects to the HOS (Holographic Organizational Semiosis) framework in the project knowledge base. The p-adic structure explains why moral injury is so devastating‚Äîit fractures identity at the Root level, requiring maximum energy to repair.
            </div>

            <div class="checkpoint">
                <div class="checkpoint-title">‚úì Check Your Understanding</div>
                <p>Why is changing a Root value (like "protect family") geometrically harder than changing an Edge value (like "maximize utility")? Explain using the concept of p-adic distance.</p>
                <textarea id="checkpoint7" aria-label="Your p-adic explanation" placeholder="Explain geometric distance between value layers..." style="min-height: 100px;"></textarea>
            </div>

            <h3>Summary: From Physics to Thermodynamics</h3>

            <div style="background: #c6f6d5; padding: 20px; border-radius: 12px; margin: 30px 0;">
                <h4 style="margin-bottom: 15px;">You've completed the complete Constructor Theory arc:</h4>
                <ul style="line-height: 2;">
                    <li><strong>Class 7 Core:</strong> Constructor Theory‚Äîcounterfactuals, transformations, knowledge as physical</li>
                    <li><strong>Class 1 Connection:</strong> Landauer's Principle‚Äîmaintaining identity costs energy</li>
                    <li><strong>Advanced Integration:</strong> P-adic structure‚Äîidentity is hierarchical, changing deep values costs exponentially more energy</li>
                </ul>
                <p style="margin-top: 20px; font-weight: bold;">This explains why institutional extraction is so devastating: It forces you to either violate Root values (maximum energy cost) or truncate to survival mode (lose sophisticated reasoning).</p>
            </div>

            <div style="background: #c6f6d5; padding: 20px; border-radius: 8px; margin: 30px 0; text-align: center;">
                <h3 style="margin-bottom: 10px;">üéì Module II Complete!</h3>
                <p><strong>Module II: The Self</strong> - You now understand:</p>
                <ul style="text-align: left; margin: 10px auto; max-width: 600px; line-height: 2;">
                    <li>Constructor Theory: physics of possibility</li>
                    <li>CIB: knowledge as physical substrate</li>
                    <li>Constructor vs Reactant: sustainable transformation</li>
                    <li>Code Integrity: maintaining your CIB</li>
                    <li>P-adic structure: hierarchical identity</li>
                    <li>Ultrametric distance: cost of value change</li>
                    <li>Thermodynamic limits: energy budget for complexity</li>
                </ul>
                <p style="margin-top: 15px; font-weight: bold;">Next: Module III - The Social Organism (how individual CIBs coordinate at scale)</p>
                <button onclick="downloadResponses()" class="success" style="margin-top: 15px;">
                    üì• Download Your Responses
                </button>
            </div>

            <div class="navigation">
                <button onclick="prevModule()">‚Üê Previous</button>
                <button onclick="location.reload()" class="primary">‚Üª Start Over</button>
            </div>
        </section>
    </div>

    <script>
        // State management
        let currentModule = 0;
        const totalModules = 8;
        let integrityLevel = 80;
        let selectedKnowledge = 'none';

        // Progress tracking
        function updateProgress() {
            const progress = Math.round((currentModule / totalModules) * 100);
            const progressFill = document.getElementById('progressFill');
            progressFill.style.width = progress + '%';
            progressFill.textContent = progress + '%';
            progressFill.setAttribute('aria-valuenow', progress);

            const completed = document.getElementById('completedModules');
            const moduleNames = [
                'Introduction', 'Counterfactuals', 'Constructor vs Reactant',
                'Knowledge as Physical', 'Universal Constructor', 'Code Integrity & Optimism', "Constructor's Dashboard", 'P-adic Identity Builder'
            ];
            
            let html = '';
            for (let i = 0; i < currentModule; i++) {
                html += `<span class="completed-module">‚úì ${moduleNames[i]}</span>`;
            }
            completed.innerHTML = html;
        }

        // Navigation
        function nextModule() {
            document.getElementById(`module${currentModule}`).classList.remove('active');
            currentModule++;
            if (currentModule < totalModules) {
                document.getElementById(`module${currentModule}`).classList.add('active');
                updateProgress();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        function prevModule() {
            if (currentModule > 0) {
                document.getElementById(`module${currentModule}`).classList.remove('active');
                currentModule--;
                document.getElementById(`module${currentModule}`).classList.add('active');
                updateProgress();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        // Trajectory animation
        function animateTrajectory() {
            const ball = document.getElementById('trajectoryBall');
            ball.style.transition = 'left 2s ease-in-out, top 2s ease-in-out';
            ball.style.left = '270px';
            ball.style.top = '90px';
            
            setTimeout(() => {
                ball.style.transition = 'none';
                ball.style.left = '10px';
                ball.style.top = '90px';
            }, 2100);
        }

        // Possibility selection
        function selectPossibility(element, choice) {
            const choices = document.querySelectorAll('.possibility-bubble');
            choices.forEach(c => c.style.background = 'rgba(255,255,255,0.2)');
            element.style.background = 'rgba(255,255,255,0.6)';
            
            document.getElementById('possibilityChoice').textContent = 
                `You selected: "${choice}" - This is a POSSIBLE transformation. The question is: do you have the Constructor (knowledge) to cause it?`;
        }

        // Knowledge selection
        function selectKnowledge(element, type) {
            document.querySelectorAll('.knowledge-option').forEach(opt => opt.classList.remove('selected'));
            element.classList.add('selected');
            selectedKnowledge = type;

            const transformSymbol = document.getElementById('transformSymbol');
            const beforeIcon = document.getElementById('beforeIcon');
            const beforeState = document.getElementById('beforeState');
            const beforeDesc = document.getElementById('beforeDesc');
            const afterIcon = document.getElementById('afterIcon');
            const afterState = document.getElementById('afterState');
            const afterDesc = document.getElementById('afterDesc');
            const afterBox = document.querySelector('.state-box.after');
            const feedback = document.getElementById('transformFeedback');

            if (type === 'none') {
                transformSymbol.textContent = '‚ùå';
                beforeIcon.textContent = 'üî¥';
                beforeState.textContent = 'Raw Materials';
                beforeDesc.textContent = 'Disordered atoms/primates';
                afterIcon.textContent = 'üî¥';
                afterState.textContent = 'Still Raw Materials';
                afterDesc.textContent = 'Without knowledge, nothing changes';
                afterBox.style.opacity = '0.3';
                feedback.style.display = 'block';
                feedback.innerHTML = '<strong>No Transformation:</strong> Without knowledge (CIB), the transformation remains in the space of possibility but never actualizes. The atoms stay disordered.';
            } else if (type === 'gene') {
                transformSymbol.textContent = 'üß¨';
                beforeIcon.textContent = '‚ö™';
                beforeState.textContent = 'Amino Acids';
                beforeDesc.textContent = 'Raw chemical building blocks';
                afterIcon.textContent = 'ü¶ã';
                afterState.textContent = 'Organism';
                afterDesc.textContent = 'Genetic knowledge constructs life';
                afterBox.style.opacity = '1';
                feedback.style.display = 'block';
                feedback.innerHTML = '<strong>Gene as Constructor:</strong> The DNA sequence is knowledge with causal power. It constructs an organism from amino acids‚Äînot once, but repeatedly (every cell division). This is a Constructor.';
            } else if (type === 'recipe') {
                transformSymbol.textContent = 'üìñ';
                beforeIcon.textContent = 'ü•ö';
                beforeState.textContent = 'Flour, Eggs, Sugar';
                beforeDesc.textContent = 'Raw ingredients';
                afterIcon.textContent = 'üéÇ';
                afterState.textContent = 'Cake';
                afterDesc.textContent = 'Recipe knowledge enables transformation';
                afterBox.style.opacity = '1';
                feedback.style.display = 'block';
                feedback.innerHTML = '<strong>Recipe as Constructor:</strong> The instructions are knowledge that enables transformation from ingredients to cake. You can use the recipe again and again‚Äîit retains its causal power. This is a Constructor.';
            } else if (type === 'ethical') {
                transformSymbol.textContent = 'ü§ù';
                beforeIcon.textContent = 'ü¶ç';
                beforeState.textContent = 'Individual Primates';
                beforeDesc.textContent = 'Self-interested agents';
                afterIcon.textContent = 'üèõÔ∏è';
                afterState.textContent = 'Cooperative Society';
                afterDesc.textContent = 'Ethical code enables coordination';
                afterBox.style.opacity = '1';
                feedback.style.display = 'block';
                feedback.innerHTML = '<strong>Ethics as Constructor:</strong> The cooperative protocols (CIBs like "Stag Hunt," "BioBond," "Code Integrity") are knowledge that transform selfish primates into coordinated society. This knowledge can be taught, transmitted, and reused‚Äîit\'s a Constructor.';
            }
        }

        // Code Integrity tracker
        function modifyIntegrity(change, action) {
            integrityLevel = Math.max(0, Math.min(100, integrityLevel + change));
            updateIntegrityDisplay();
        }

        function updateIntegrityDisplay() {
            const fill = document.getElementById('integrityFill');
            const status = document.getElementById('integrityStatus');

            fill.style.width = integrityLevel + '%';
            fill.textContent = integrityLevel + '% Intact';

            if (integrityLevel > 60) {
                fill.style.background = 'linear-gradient(90deg, #48bb78, #38a169)';
                status.textContent = 'Your CIB is intact. You can cause transformations repeatedly. You are a Constructor.';
                status.style.color = '#48bb78';
            } else if (integrityLevel > 30) {
                fill.style.background = 'linear-gradient(90deg, #ed8936, #dd6b20)';
                status.textContent = 'Your CIB is degrading. You\'re becoming less effective. Restore before you become a Reactant.';
                status.style.color = '#ed8936';
            } else {
                fill.style.background = 'linear-gradient(90deg, #f56565, #e53e3e)';
                status.textContent = 'Your CIB is shattered. You\'ve become a Reactant. You can cause transformation once, then you\'re burned out. Restore immediately.';
                status.style.color = '#f56565';
            }
        }

        // Problem analyzer
        function analyzeProblem() {
            const name = document.getElementById('problemName').value.trim();
            const physics = document.getElementById('problemPhysics').value;
            const result = document.getElementById('analysisResult');

            if (!name || !physics) {
                alert('Please fill in both fields');
                return;
            }

            result.style.display = 'block';

            if (physics === 'violates') {
                result.className = 'analysis-result impossible';
                result.innerHTML = `
                    <h3 style="color: #f56565; margin-bottom: 10px;">‚ùå IMPOSSIBLE</h3>
                    <p><strong>"${name}"</strong> violates the laws of physics.</p>
                    <p style="margin-top: 10px;">This problem is <strong>impossible</strong> to solve‚Äîit's forbidden by physical law. No amount of knowledge can change this. We must accept this constraint and work within it.</p>
                    <p style="margin-top: 15px; font-style: italic;">Examples: Faster-than-light travel, perpetual motion machines, creating energy from nothing.</p>
                `;
            } else {
                result.className = 'analysis-result possible';
                result.innerHTML = `
                    <h3 style="color: #48bb78; margin-bottom: 10px;">‚úÖ SOLUBLE</h3>
                    <p><strong>"${name}"</strong> does not violate the laws of physics.</p>
                    <p style="margin-top: 10px;">This problem is <strong>soluble</strong>. If it's allowed by physics, the only barrier is knowledge. The evil of this problem is caused by our current <em>lack of knowledge</em>, not by the nature of reality.</p>
                    <p style="margin-top: 15px;"><strong>Your duty:</strong> Create or acquire the knowledge (CIB) required to solve it. This transforms you from passive observer to active Constructor.</p>
                    <p style="margin-top: 15px; font-weight: bold;">The Principle of Optimism: We must keep creating knowledge, keep the Open Society open, and never accept suffering as inevitable.</p>
                `;
            }
        }

        // Dashboard analyzer
        function runDashboard() {
            const task = document.getElementById('dashboardTask').value.trim();
            const physics = document.getElementById('dashboardPhysics').value;
            const knowledge = document.getElementById('dashboardKnowledge').value;
            const cost = document.getElementById('dashboardCost').value;
            const result = document.getElementById('dashboardResult');

            if (!task || !physics || !knowledge || !cost) {
                alert('Please complete all four steps');
                return;
            }

            result.style.display = 'block';

            if (physics === 'impossible') {
                result.className = 'dashboard-result redesign';
                result.innerHTML = `
                    <h3 style="color: #f56565;">‚ùå Cannot Proceed</h3>
                    <p>This transformation violates the laws of physics. It is <strong>impossible</strong>. You must redefine your task to align with what's physically possible.</p>
                `;
            } else if (knowledge === 'no') {
                result.className = 'dashboard-result learn';
                result.innerHTML = `
                    <h3 style="color: #ed8936;">üìö Your Duty: Learn First</h3>
                    <p><strong>Task:</strong> ${task}</p>
                    <p style="margin-top: 10px;">You lack the necessary CIB (knowledge) to act as Constructor here. <strong>Do NOT act yet.</strong> Acting without knowledge makes you a chaotic variable‚Äîyou'll cause more harm than good.</p>
                    <p style="margin-top: 15px;"><strong>Action:</strong> Your ethical duty is to <em>learn</em>. Acquire the specific knowledge required. Then return to this dashboard.</p>
                `;
            } else if (cost === 'destructive') {
                result.className = 'dashboard-result redesign';
                result.innerHTML = `
                    <h3 style="color: #f56565;">üîÑ Redesign Required</h3>
                    <p><strong>Task:</strong> ${task}</p>
                    <p style="margin-top: 10px;">This approach will destroy your ability to function tomorrow‚Äîyou'll become a <strong>Reactant</strong>, not a Constructor. You cannot sustain this.</p>
                    <p style="margin-top: 15px;"><strong>Action:</strong> Redesign your approach. Build a BioBond/team to distribute the load. Change the timeline. Protect your Code Integrity.</p>
                `;
            } else if (knowledge === 'partial' || cost === 'needs-redesign') {
                result.className = 'dashboard-result learn';
                result.innerHTML = `
                    <h3 style="color: #ed8936;">‚ö†Ô∏è Proceed With Caution</h3>
                    <p><strong>Task:</strong> ${task}</p>
                    <p style="margin-top: 10px;">You have some knowledge and sustainable approach, but gaps remain. You can begin, but recognize limitations.</p>
                    <p style="margin-top: 15px;"><strong>Action:</strong> Start small. Learn as you go. Build support systems. Monitor your Code Integrity continuously.</p>
                `;
            } else {
                result.className = 'dashboard-result proceed';
                result.innerHTML = `
                    <h3 style="color: #48bb78;">‚úÖ Proceed as Constructor</h3>
                    <p><strong>Task:</strong> ${task}</p>
                    <p style="margin-top: 10px;">‚úì Physically possible<br>‚úì You have the CIB (knowledge)<br>‚úì Sustainable approach</p>
                    <p style="margin-top: 15px;"><strong>Action:</strong> Proceed. You are acting as a Constructor‚Äîyou can cause this transformation while retaining capacity for future transformations. This is ethical action.</p>
                `;
            }
        }

        // P-adic Distance Calculator
        function calculatePadicDistance() {
            // Get selected values
            const trunkValues = Array.from(document.querySelectorAll('input[name="trunk"]:checked')).map(cb => cb.value);
            const edgeValues = Array.from(document.querySelectorAll('input[name="edge"]:checked')).map(cb => cb.value);

            if (trunkValues.length === 0 && edgeValues.length === 0) {
                alert('Please select at least one value from Trunk or Edge layers');
                return;
            }

            const result = document.getElementById('padicResult');
            result.style.display = 'block';

            // Define alternative value systems
            const alternatives = [
                {
                    name: 'Pure Utilitarian',
                    trunk: ['honesty'],
                    edge: ['utility'],
                    description: 'Maximize aggregate welfare; honesty as instrumental value'
                },
                {
                    name: 'Strict Kantian',
                    trunk: ['honesty', 'authority'],
                    edge: ['categorical'],
                    description: 'Follow universal law; respect for duty and authority'
                },
                {
                    name: 'Traditional Conservative',
                    trunk: ['authority', 'hard_work', 'loyalty', 'tradition'],
                    edge: [],
                    description: 'Value tradition and loyalty; minimal abstract philosophy'
                },
                {
                    name: 'Care Ethicist',
                    trunk: ['loyalty'],
                    edge: ['care', 'virtue'],
                    description: 'Prioritize relationships and character development'
                },
                {
                    name: 'Social Justice Advocate',
                    trunk: [],
                    edge: ['justice', 'utility', 'care'],
                    description: 'Focus on systemic reform and equal capabilities'
                }
            ];

            let html = '<div style="background: white; padding: 25px; border-radius: 12px; border: 3px solid #805ad5;">';
            html += '<h3 style="color: #805ad5; margin-bottom: 20px;">üìê Your P-adic Distance Analysis</h3>';
            html += '<p style="margin-bottom: 20px;"><strong>Your Identity:</strong></p>';
            html += '<ul style="line-height: 2; margin-bottom: 20px;">';
            html += '<li>üå± Root: [Fixed - protect family, seek safety, avoid pain]</li>';
            html += '<li>üå≥ Trunk: ' + (trunkValues.length > 0 ? trunkValues.join(', ') : 'None selected') + '</li>';
            html += '<li>üåø Edge: ' + (edgeValues.length > 0 ? edgeValues.join(', ') : 'None selected') + '</li>';
            html += '</ul>';

            html += '<div style="background: #f7fafc; padding: 20px; border-radius: 8px; margin: 20px 0;">';
            html += '<h4 style="margin-bottom: 15px;">Distance to Alternative Value Systems</h4>';
            html += '<p style="font-size: 0.9em; margin-bottom: 15px; font-style: italic;">Using p-adic ultrametric: d<sub>p</sub>(Œ®‚ÇÅ, Œ®‚ÇÇ) = p<sup>-k</sup> where k = first differing coefficient</p>';

            alternatives.forEach(alt => {
                // Calculate first point of divergence
                // Root always matches (everyone has biological values)
                // Check Trunk layer
                let divergence = 10; // Start assuming agreement
                let divergenceLayer = 'Edge';

                // Compare trunk values
                const trunkMatch = trunkValues.length > 0 && alt.trunk.length > 0 && 
                    trunkValues.some(v => alt.trunk.includes(v));
                
                if (!trunkMatch && (trunkValues.length > 0 || alt.trunk.length > 0)) {
                    divergence = 3; // Differ at trunk level
                    divergenceLayer = 'Trunk';
                }

                // If trunk matches, check edge
                if (divergence === 10) {
                    const edgeMatch = edgeValues.length > 0 && alt.edge.length > 0 && 
                        edgeValues.some(v => alt.edge.includes(v));
                    
                    if (!edgeMatch && (edgeValues.length > 0 || alt.edge.length > 0)) {
                        divergence = 8;
                        divergenceLayer = 'Edge';
                    }
                }

                // Calculate p-adic distance (using p=7 as base)
                const p = 7;
                const distance = Math.pow(p, -divergence);
                
                // Determine color based on distance
                let color = '#c6f6d5';
                let borderColor = '#48bb78';
                if (distance > 0.1) {
                    color = '#fed7d7';
                    borderColor = '#f56565';
                } else if (distance > 0.01) {
                    color = '#feebc8';
                    borderColor = '#ed8936';
                }

                html += '<div style="background: ' + color + '; padding: 15px; margin: 10px 0; border-radius: 8px; border-left: 4px solid ' + borderColor + ';">';
                html += '<h5 style="margin-bottom: 8px;">' + alt.name + '</h5>';
                html += '<p style="font-size: 0.9em; margin-bottom: 10px;">' + alt.description + '</p>';
                html += '<p><strong>Distance:</strong> d<sub>p</sub> = ' + distance.toFixed(4) + ' (diverge at ' + divergenceLayer + ' layer)</p>';
                
                if (distance < 0.01) {
                    html += '<p style="margin-top: 8px; font-weight: bold; color: #22543d;">‚úì Very close - Easy to coordinate</p>';
                } else if (distance < 0.1) {
                    html += '<p style="margin-top: 8px; font-weight: bold; color: #7c2d12;">‚ö† Moderate distance - Requires bridge-building</p>';
                } else {
                    html += '<p style="margin-top: 8px; font-weight: bold; color: #742a2a;">‚úó Large distance - Major coordination friction</p>';
                }
                html += '</div>';
            });

            html += '</div>';

            html += '<div style="background: #e6fffa; padding: 20px; border-radius: 8px; margin-top: 20px; border-left: 4px solid #319795;">';
            html += '<h4 style="margin-bottom: 15px;">üîë Key Insights</h4>';
            html += '<ul style="line-height: 2;">';
            html += '<li><strong>Small distances (< 0.01):</strong> You diverge only at Edge (philosophy). Easy to have productive debates.</li>';
            html += '<li><strong>Medium distances (0.01-0.1):</strong> You diverge at Trunk (culture). Need translation work to coordinate.</li>';
            html += '<li><strong>Large distances (> 0.1):</strong> You diverge at Root (biology). Coordination may be thermodynamically impossible without deep identity restructuring.</li>';
            html += '</ul>';
            html += '<p style="margin-top: 15px; font-weight: bold;">This is why "just talk it out" fails when people diverge at Root or Trunk levels. The geometric distance is too large for casual conversation to bridge.</p>';
            html += '</div>';

            html += '</div>';

            result.innerHTML = html;
        }

        // Download responses
        function downloadResponses() {
            const checkpoints = [
                'checkpoint0', 'checkpoint1', 'checkpoint2', 
                'checkpoint3', 'checkpoint4', 'checkpoint5', 'checkpoint6', 'checkpoint7'
            ];
            
            const labels = [
                'Introduction: Trajectories vs Counterfactuals',
                'Module 1: Counterfactuals Analysis',
                'Module 2: Reactant Experience',
                'Module 3: Transformation & Knowledge',
                'Module 4: Universal Constructor',
                'Module 5: Code Integrity Challenge',
                'Module 6: Constructor Dashboard Application',
                'Module 7: P-adic Distance Explanation'
            ];
            
            let content = 'THE PHYSICS OF POSSIBILITY - LEARNING RESPONSES\n';
            content += '='.repeat(60) + '\n\n';
            
            checkpoints.forEach((id, i) => {
                const textarea = document.getElementById(id);
                if (textarea && textarea.value.trim()) {
                    content += labels[i] + '\n';
                    content += '-'.repeat(60) + '\n';
                    content += textarea.value.trim() + '\n\n';
                }
            });

            content += 'METRICS\n';
            content += '-'.repeat(60) + '\n';
            content += `Final Code Integrity Level: ${integrityLevel}%\n\n`;
            
            content += '\nCompleted: ' + new Date().toLocaleString();
            
            const blob = new Blob([content], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'physics_of_possibility_responses.txt';
            a.click();
            URL.revokeObjectURL(url);
        }

        // Initialize
        window.addEventListener('load', () => {
            updateProgress();
            updateIntegrityDisplay();
            document.querySelector('h1').focus();
        });
    </script>
</body>
</html>
